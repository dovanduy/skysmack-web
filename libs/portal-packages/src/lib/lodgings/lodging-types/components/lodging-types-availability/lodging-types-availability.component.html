<ss-container [componentKey]="'lodging-types-availability-index'" [componentKey]="componentKey">

  <!-- Lodgings selection -->
  <mat-form-field>
    <mat-select [(value)]="selectedLodgingTypeIds" [placeholder]="'LODGING_TYPES.AVAILABILITY.PLACEHOLDER' | translate"
      multiple>
      <mat-option *ngFor="let opt of lodgingTypeOptions$ | async" [value]="opt.value"
        (click)="getAvailableLodgingTypes()">
        {{opt.displayName}}</mat-option>
    </mat-select>
  </mat-form-field>

  <!-- Calendar -->
  <ng-template #customCellTemplate let-day="day" let-locale="locale">
    <ng-container *ngIf="day.freeLodgingTypes">
      <div class="cal-cell-top">
        <span class="cal-day-number">{{ day.date | calendarDate:'monthViewDayNumber':locale }}</span>
      </div>
      <div class="cell-totals">
        <ng-container *ngFor="let freeLodgingTypes of day.freeLodgingTypes; trackBy: trackById">
          <p *ngIf="freeLodgingTypes.count > 0" style="color:green;">{{ freeLodgingTypes.name }}: {{
            freeLodgingTypes.count }}</p>
          <p *ngIf="!freeLodgingTypes.count || freeLodgingTypes.count === 0" style="color:black;">
            {{ freeLodgingTypes.name }}: {{
            freeLodgingTypes.count }}</p>
          <p *ngIf="freeLodgingTypes.count < 0" style="color:red;">{{ freeLodgingTypes.name }}: {{
              freeLodgingTypes.count }}</p>
        </ng-container>
      </div>
    </ng-container>
  </ng-template>
  <ng-container *ngIf="events$ | async as events">
    <div [ngSwitch]="view">
      <h2 style="position: relative;">

      <div style="float:right;margin-right:16px">
        <button mat-icon-button mwlCalendarToday [(viewDate)]="viewDate"
          matTooltip="{{ 'LODGING_TYPES.AVAILABILITY.TODAY' | translate }}">
          <mat-icon>calendar_today</mat-icon>
        </button>

        <button mat-icon-button mwlCalendarPreviousView [view]="view" [(viewDate)]="viewDate"
          matTooltip="{{ 'LODGING_TYPES.AVAILABILITY.PREVIOUS' | translate }}">
          <mat-icon>chevron_left</mat-icon>
        </button>
        
        <button mat-icon-button mwlCalendarNextView [view]="view" [(viewDate)]="viewDate"
          matTooltip="{{ 'LODGING_TYPES.AVAILABILITY.NEXT' | translate }}">
          <mat-icon>chevron_right</mat-icon>
        </button>
      </div>
        
        <span style="position: relative;top:8px">
            {{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}
          </span>
      </h2>

      <mwl-calendar-month-view *ngSwitchCase="'month'" [viewDate]="viewDate" [events]="events"
        (dayClicked)="viewDate = $event.day.date;" (beforeViewRender)="beforeMonthViewRender($event)"
        [cellTemplate]="customCellTemplate">
      </mwl-calendar-month-view>
      <mwl-calendar-week-view *ngSwitchCase="'week'" [viewDate]="viewDate" [events]="events"
        (dayHeaderClicked)="viewDate = $event.day.date; view = 'day';">
      </mwl-calendar-week-view>
      <mwl-calendar-day-view *ngSwitchCase="'day'" [viewDate]="viewDate" [events]="events">
      </mwl-calendar-day-view>
    </div>
  </ng-container>
</ss-container>